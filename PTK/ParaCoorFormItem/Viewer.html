<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>D3 Test</title>
    <link rel="stylesheet" type="text/css" href="d3.parcoords.css">
    <link rel="stylesheet" type="text/css" href="Viewer.css">
</head>
<body>
    <script src="d3/d3.min.js"></script>
    <script src="d3.parcoords.js"></script>
    <script src="divgrid.js"></script>


    <div id="example" class="parcoords" style="width:880px;height:450px"></div>
    <div id="grid"></div>


    <script>

        function updateData(arg1) {
            var data = JSON.parse(arg1);

            var pc = d3.parcoords()("#example") //表作成
                .data(data)             //データセット
                .render()               //描画
                .createAxes()           //次元名、ラベルを含む静的軸を作成
                .brushMode("1D-axes");  // enable brushing;

            // create data table, row hover highlighting
            var grid = d3.divgrid();
            d3.select("#grid")
                .datum(data.slice(0, 10))
                .call(grid)
                .selectAll(".row")
                .on({
                    "mouseover": function (d) { pc.highlight([d]) },
                    "mouseout": pc.unhighlight,
                    "click": function (d) { returnPick(JSON.stringify(d)) }
                });
            
            // update data table on brush event
            pc.on("brush", function (d) {
                d3.select("#grid")
                    .datum(d.slice(0, 10))
                    .call(grid)
                    .selectAll(".row")
                    .on({
                        "mouseover": function (d) { pc.highlight([d]) },
                        "mouseout": pc.unhighlight,
                        "click": function (d) { returnPick(JSON.stringify(d)) }
                    });
            });

        }

        //選択されたデータをC#プログラムに返す
        function returnPick(d) {
            window.external.ReceiveChoiceDataFunction(d);
        }

    </script>
</body>
</html>